pipeline{
  agent any
  tools{
   maven 'maven-3.9.1'
  }
  stages{
   stage('Code Build'){
      steps{
        sh 'mvn clean package'
      }
    }
    stage('Install Tomcat')
    { 
      steps
      {
        sh 'sleep 30'
        sh 'ssh-keyscan -H -f /var/lib/jenkins/workspace/Webserver/1_Deploy_Infrastructure_on_AWS/inventory >> /var/lib/jenkins/.ssh/known_hosts'
        ansiblePlaybook become: true, disableHostKeyChecking: true, extras: '-e ansible_user=ubuntu --flush-cache',installation: 'ansible', inventory: '/var/lib/jenkins/workspace/Webserver/1_Deploy_Infrastructure_on_AWS/inventory', playbook: '/var/lib/jenkins/workspace/Webserver/1_Deploy_Infrastructure_on_AWS/deploy_tomcat.yml'      }
   }
  }
}
